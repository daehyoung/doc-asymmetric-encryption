
# 작업 증명(Proof of Work, PoW)

비트코인 블록체인에서 블록을 생성할 때, 블록의 해시를 계산하는 과정에는 이전 블록의 해시값이 포함됩니다. 그러나 블록의 해시에 서명을 하는 과정은 없습니다. 대신, 비트코인 블록체인은 작업 증명(Proof of Work, PoW) 메커니즘을 사용하여 블록을 검증하고 네트워크의 합의를 얻습니다. 아래는 이 과정에 대한 자세한 설명입니다.

### 블록 생성 과정

1. **블록 헤더 구성**:
   - **이전 블록의 해시(Prev Block Hash)**: 현재 생성 중인 블록의 헤더에는 이전 블록의 해시가 포함됩니다. 이를 통해 블록체인이 연결된 상태를 유지합니다.
   - **머클 루트(Merkle Root)**: 현재 블록에 포함된 모든 트랜잭션의 해시를 머클 트리로 구성한 후, 머클 루트를 계산하여 블록 헤더에 포함합니다.
   - **타임스탬프(Timestamp)**: 블록이 생성된 시점을 나타냅니다.
   - **난이도 목표(Target Difficulty)**: 현재 블록을 채굴하기 위한 난이도 수준을 나타냅니다.
   - **논스(Nonce)**: 블록의 해시값을 난이도 목표에 맞추기 위해 변동되는 값입니다.

2. **작업 증명(Proof of Work)**:
   - **해시 계산**: 채굴자는 위의 블록 헤더 정보를 포함하여 해시값을 계산합니다. 이 해시값은 SHA-256 해시 함수로 계산됩니다.
   - **해시값 비교**: 계산된 해시값이 난이도 목표보다 작아야 합니다. 이를 위해 논스 값을 반복적으로 변경하며 올바른 해시값을 찾습니다.

3. **블록 채굴 및 전파**:
   - **블록 채굴**: 채굴자는 올바른 해시값을 찾으면 블록이 채굴되었다고 말합니다.
   - **블록 전파**: 채굴된 블록은 네트워크에 전파되고, 다른 노드들은 이 블록을 검증합니다.

### 서명 과정과의 차이점

- **트랜잭션 서명**: 블록 자체에는 서명 과정이 없지만, 블록에 포함된 각 트랜잭션은 개별적으로 서명됩니다. 트랜잭션 서명은 발신자가 자신의 프라이빗 키를 사용하여 트랜잭션에 서명함으로써, 자신이 해당 비트코인의 소유자임을 증명하는 과정입니다.
- **블록 검증**: 채굴된 블록은 서명되지 않지만, PoW를 통해 검증됩니다. 다른 노드들은 새 블록이 올바르게 채굴되었는지, 즉 난이도 목표를 만족하는 해시값을 가지고 있는지를 확인합니다.

### 요약

비트코인 블록체인에서는 각 블록의 해시를 계산할 때 이전 블록의 해시를 포함하여 연결성을 유지합니다. 블록 자체에 서명을 하는 과정은 없으며, 대신 PoW 메커니즘을 사용하여 블록을 검증합니다. 개별 트랜잭션은 발신자의 프라이빗 키로 서명되지만, 블록은 PoW를 통해 네트워크의 합의를 얻습니다.



# 비트코인 트랜잭션의 서명

비트코인 트랜잭션의 서명은 발신자가 자신의 비트코인을 보내기 위해 트랜잭션에 디지털 서명을 추가하는 과정입니다. 이 서명은 발신자가 해당 트랜잭션의 유효성을 증명하고, 비트코인을 전송할 권한이 있음을 보장합니다. 트랜잭션 서명 과정은 다음과 같이 이루어집니다:

### 1. 트랜잭션 생성

트랜잭션을 생성할 때 다음과 같은 필수 정보가 포함됩니다:
- **입력(Input)**: 이전 트랜잭션의 UTXO를 참조합니다. 여기에는 이전 트랜잭션의 해시와 출력 인덱스가 포함됩니다.
- **출력(Output)**: 비트코인을 받는 주소와 보낼 금액이 포함됩니다.

### 2. 트랜잭션 해시 생성

트랜잭션의 중요한 요소를 모아서 해시를 생성합니다. 이 해시를 트랜잭션 ID라고 부르며, SHA-256 해시 함수로 계산됩니다. 서명을 위해 해시가 한 번 더 처리됩니다(SHA-256을 두 번 적용).

### 3. 디지털 서명 생성

발신자는 자신의 프라이빗 키를 사용하여 트랜잭션 해시에 서명합니다. 서명 과정은 다음과 같습니다:
1. **트랜잭션 해시**: 발신자가 전송하고자 하는 트랜잭션의 해시를 생성합니다.
2. **서명 알고리즘**: ECDSA(타원곡선 디지털 서명 알고리즘)를 사용하여 발신자의 프라이빗 키와 트랜잭션 해시로 서명을 생성합니다. 서명은 두 개의 값 (r, s)로 구성됩니다.

### 4. 트랜잭션에 서명 추가

서명된 트랜잭션은 발신자의 서명과 공개 키를 포함합니다. 공개 키는 발신자가 서명을 생성할 때 사용된 프라이빗 키와 짝을 이루며, 네트워크에서 서명을 검증하는 데 사용됩니다.

### 5. 트랜잭션 전파 및 검증

서명된 트랜잭션은 네트워크에 전파되며, 각 노드는 다음 과정을 통해 서명의 유효성을 검증합니다:
1. **공개 키 검증**: 발신자가 제공한 공개 키를 사용하여 서명을 검증합니다. 공개 키는 트랜잭션 해시와 서명이 일치하는지 확인하는 데 사용됩니다.
2. **UTXO 검증**: 트랜잭션 입력이 참조하는 UTXO가 유효하며, 현재 사용되지 않은 상태인지 확인합니다.

### 트랜잭션 예시

가령, Alice가 Bob에게 1 BTC를 보내고자 할 때 다음과 같은 과정이 이루어집니다:

1. **트랜잭션 생성**: Alice는 이전에 받은 트랜잭션의 UTXO를 입력으로 사용하여 새로운 트랜잭션을 생성하고, 1 BTC를 Bob의 주소로 보냅니다.
2. **트랜잭션 해시**: Alice의 지갑 소프트웨어가 트랜잭션 해시를 생성합니다.
3. **디지털 서명**: Alice의 지갑 소프트웨어가 Alice의 프라이빗 키로 트랜잭션 해시에 서명합니다.
4. **트랜잭션 전파**: 서명된 트랜잭션이 네트워크에 전파됩니다.
5. **트랜잭션 검증**: 네트워크의 노드들은 Alice의 공개 키로 서명을 검증하고, 트랜잭션의 UTXO가 유효한지 확인합니다.

이 과정을 통해 Alice는 자신의 비트코인을 Bob에게 안전하게 보낼 수 있습니다. 각 단계에서 암호학적 서명과 해시 함수를 사용하여 트랜잭션의 무결성과 발신자의 권한을 보장합니다.
