# 비트코인 트랜젝션

## 거래소를 이용한 트랜잭션 시나리오

비트코인과 같은 암호화폐를 거래소에서 거래할 때, 특히 바이낸스와 같은 중앙화된 거래소(Centralized Exchange, CEX)를 이용할 때 거래 과정과 기록이 다음과 같은 방식으로 이루어집니다.

### 거래소 내부 기록
1. **거래소 계정 생성 및 입금**:
   - 사용자는 바이낸스 계정을 생성하고, 해당 계정에 미국 달러(USD) 또는 다른 법정 화폐를 입금합니다.
   - 이 단계에서의 입금은 거래소의 은행 계좌를 통해 이루어지며, 이 내용은 바이낸스의 내부 시스템에 기록됩니다.

2. **비트코인 구매 주문**:
   - 사용자가 비트코인을 구매하면, 바이낸스는 내부 장부에 사용자의 달러 잔고를 감소시키고, 해당하는 비트코인 잔고를 증가시킵니다.
   - 이 거래는 바이낸스의 중앙화된 데이터베이스에 기록됩니다. 여기에는 구매자의 ID, 거래 금액, 구매한 비트코인 수량 등이 포함됩니다.
   
3. **거래소 내 자산 이동**:
   - 사용자가 거래소 내에서 비트코인 구매/판매를 반복하는 경우, 이 모든 거래는 바이낸스의 내부 시스템에 기록됩니다.
   - 이 단계의 거래는 실제 블록체인 네트워크에 전파되지 않으며, 거래소 내부 데이터베이스에만 기록됩니다.

### 블록체인 기록
1. **비트코인 인출**:
   - 사용자가 바이낸스에서 자신의 개인 지갑으로 비트코인을 출금하기로 결정하면, 이 시점에 트랜잭션이 비트코인 블록체인에 기록됩니다.
   - 사용자는 바이낸스에서 인출 요청을 하고, 바이낸스는 해당 요청을 처리하여 사용자가 지정한 비트코인 주소로 비트코인을 전송합니다.
   - 이 트랜잭션은 비트코인 네트워크에 전파되고, 채굴자들에 의해 블록에 포함되어 블록체인에 기록됩니다.
   
2. **블록체인 트랜잭션 내용**:
   - 블록체인에 기록되는 트랜잭션에는 다음과 같은 정보가 포함됩니다:
     - 송금자 주소(바이낸스의 비트코인 주소)
     - 수신자 주소(사용자의 비트코인 주소)
     - 전송된 비트코인 수량
     - 트랜잭션 수수료
     - 트랜잭션 해시 (TxID)
   - 이러한 트랜잭션은 모두 공개적으로 확인할 수 있으며, 누구나 블록 탐색기를 통해 조회할 수 있습니다.

### 요약
- **거래소 내부 기록**: 사용자의 법정 화폐 입금, 비트코인 매수/매도, 계좌 잔고 변화 등의 정보가 바이낸스의 중앙화된 데이터베이스에 기록됩니다.
- **블록체인 기록**: 사용자가 비트코인을 인출할 때, 해당 트랜잭션이 비트코인 블록체인에 기록됩니다. 여기에는 송수신 주소, 전송된 비트코인 수량, 트랜잭션 수수료 등이 포함됩니다.

따라서, 거래소에서 비트코인을 거래할 때의 모든 과정이 블록체인에 기록되는 것은 아니며, 거래소 내부에서 이루어지는 대부분의 거래는 해당 거래소의 데이터베이스에만 기록됩니다. 오직 거래소에서 외부 지갑으로 비트코인을 인출할 때만 비트코인 블록체인에 기록됩니다.

 ## 블록체인 기록
 1. 비트코인 인출을 요청하면
 2. 사용자는 출금자 지갑주소
  출금자 지갑주소, 비트코인 수량, 수수료(보통 자동 입력됨)를 입력 한다.

 3. 거래소는 트랜잭션을 생성한다.
    송금자 지갑주소(바이낸스의 비트코인 주소)
    출금자 지갑주소(개인 비트코인 지갑 주소)
    비트코인 수량
    트랜잭션 해시
    트랜잭션 수수료
        
5. 송금자의 개인키(바이낸스 개인키)로 서명한다.
   비트코인 네트워크에 전송한다.
6. 비트코인 네트워크는 해당 트랜잭션을 검증하고 유효한 트랜잭션이면 블럭에 추가한다.
7. 거래소 화면에 전송중으로 표시한다.
8. 비트코인 네트워크는 우선순위에 따라 트랜잭션을 블록에 추가한다.
- 보통 1개의 블록을 생성하는데 약 10분 정도 소요된다. 빠르면 10분안에 첫번째 블록에 기록된다.
- 채굴자는 작업 증명(Proof of work)을 통해 블록이 유효한 블록임을 증명한다. - 블록 해시를 계산하는데, 난이도에 따라 블록 해시 값이 특정 패턴을 갖도록 하기 위해, 반복적으로 블럭 해시 + 논스 (순차적인 증가 값)로 해시를 계산한다. (해시 계산에 평균 10분 정도 걸리도록 알고리즘적으로 난이도가 자동 조정되도록 되어 있다.)
- 트랜잭션 수수료를 많이 지급하면 블록에 포함될 확률이 높아진다.
9. 트랜잭션이 블록에 포함되면 거래소 화면의 상태가 변경된다.
- 처음 블록에 기록되면 상태에 "1 Confirmations" 이라고 표시된다. 두 번째 블록이 생성되면 트랜잭션은 "2 Confirmations"를 받게 된다. 비트코인 네트워크에서는 일반적으로 6번의 확인을 받으면 트랜잭션이 완전히 안전한 것으로 간주된다.
- "6 Confirmations" 까지 약 1시간에서 1시간 30분 정도 소요된다.
 
- 트랜잭션 포함 블록:
  - 블록 N: 트랜잭션이 포함됨 (1 Confirmation)
- 추가 블록:
  - 블록 N+1: 2 Confirmations
  - 블록 N+2: 3 Confirmations
  - 블록 N+3: 4 Confirmations
  - 블록 N+4: 5 Confirmations
  - 블록 N+5: 6 Confirmations


    

## 비트코인 전송 시간 지연 이유
비트코인을 바이낸스 지갑에서 개인 소유의 하드웨어 지갑으로 전송하는 데 시간이 걸리는 이유는 여러 가지가 있을 수 있습니다. 주요 이유들은 다음과 같습니다:

1. **네트워크 혼잡**: 비트코인 네트워크는 전 세계적으로 사용되고 있으며, 특정 시간대에 트랜잭션 수가 급증할 수 있습니다. 이러한 경우 트랜잭션 처리 속도가 느려질 수 있습니다.

2. **채굴자 수수료**: 트랜잭션이 빠르게 처리되기 위해서는 충분한 수수료를 지불해야 합니다. 수수료가 낮을 경우, 트랜잭션이 블록에 포함되기까지 오랜 시간이 걸릴 수 있습니다.

3. **바이낸스의 내부 처리 시간**: 바이낸스와 같은 거래소는 보안상의 이유로 출금 요청을 내부적으로 검토하고 승인하는 절차를 거칩니다. 이 과정에서 시간이 추가로 소요될 수 있습니다.

4. **확인 시간**: 비트코인 트랜잭션은 블록체인에 기록되기 위해 여러 번의 확인(confirmation)을 거쳐야 합니다. 일반적으로 거래소는 출금을 위해 몇 번의 확인을 요구하며, 이로 인해 시간이 더 소요될 수 있습니다.

5. **보안 검사**: 출금 요청에 대한 보안 검사가 포함될 수 있습니다. 비정상적인 활동이 감지되면 추가 검토 절차가 필요할 수 있습니다.

위의 이유들로 인해 비트코인을 거래소 지갑에서 하드웨어 지갑으로 전송하는 데 몇 분 이상 걸릴 수 있습니다. 이러한 상황에서는 조금 기다리거나, 수수료를 높여 트랜잭션 속도를 높이는 방법을 고려할 수 있습니다.


## 비트코인 트랜잭션 운선 순위


비트코인 트랜잭션이 완료되려면 해당 트랜잭션이 블록에 기록되어야 합니다. 채굴자들이 비싼 수수료를 지급하는 트랜잭션을 우선적으로 블록에 넣어 기록하는 이유는 다음과 같습니다:

1. **채굴자 수익 극대화**: 채굴자들은 트랜잭션 수수료와 블록 보상을 통해 수익을 얻습니다. 트랜잭션 수수료가 높은 트랜잭션을 블록에 포함시키면 더 많은 수익을 얻을 수 있습니다. 따라서, 채굴자들은 자연스럽게 더 높은 수수료를 지불하는 트랜잭션을 우선적으로 선택합니다.

2. **블록 크기 제한**: 비트코인 블록은 최대 1MB의 데이터를 포함할 수 있습니다. 이로 인해, 한 블록에 포함될 수 있는 트랜잭션의 수가 제한됩니다. 트랜잭션이 많을 때, 채굴자들은 수수료가 높은 트랜잭션을 우선 선택하여 블록을 채우려고 합니다.

3. **경쟁**: 네트워크가 혼잡할 때는 많은 트랜잭션이 동시에 발생합니다. 이러한 경우, 트랜잭션이 블록에 포함되기 위해 경쟁하게 됩니다. 수수료가 높을수록 트랜잭션이 블록에 포함될 가능성이 높아지고, 따라서 더 빨리 처리됩니다.

4. **트랜잭션 우선순위**: 트랜잭션은 수수료/바이트 비율에 따라 우선순위가 매겨집니다. 즉, 수수료가 높고 트랜잭션 크기가 작을수록 해당 트랜잭션은 블록에 포함될 가능성이 높아집니다.

예를 들어, 트랜잭션 풀(메모리 풀)에 두 개의 트랜잭션이 있다고 가정해봅시다:

- 트랜잭션 A: 수수료 0.0005 BTC, 크기 250 바이트
- 트랜잭션 B: 수수료 0.0003 BTC, 크기 300 바이트

채굴자는 수수료/바이트 비율이 더 높은 트랜잭션을 우선적으로 선택할 것입니다. 트랜잭션 A의 수수료/바이트 비율은 0.0005 BTC / 250 바이트 = 0.000002 BTC/바이트이며, 트랜잭션 B의 수수료/바이트 비율은 0.0003 BTC / 300 바이트 = 0.000001 BTC/바이트입니다. 따라서, 트랜잭션 A가 더 빨리 블록에 포함될 가능성이 높습니다.

결론적으로, 채굴자들이 비싼 수수료를 지급하는 트랜잭션을 우선적으로 블록에 넣어 기록하는 이유는 그들이 더 높은 수익을 추구하기 때문입니다. 이로 인해 수수료가 높은 트랜잭션은 더 빠르게 처리될 가능성이 높아집니다.


## 수수료 계산 방법

비트코인 트랜잭션 수수료는 여러 요소에 따라 결정되며, 트랜잭션을 기록하려는 사용자는 현재 바이트당 수수료를 알기 위해 다양한 정보 소스를 활용할 수 있습니다. 주요 절차와 정보를 얻는 방법은 다음과 같습니다:

1. **수수료 계산 방법**:
    - **트랜잭션 크기**: 트랜잭션의 크기는 바이트 단위로 측정됩니다. 트랜잭션의 크기는 입력과 출력의 수에 따라 달라집니다.
    - **수수료/바이트 비율**: 트랜잭션이 네트워크에서 빠르게 처리되기 위해서는 적절한 수수료/바이트 비율을 설정해야 합니다.

2. **현재 수수료 수준 파악**:
    - **비트코인 수수료 추적 사이트**: 여러 웹사이트에서 현재의 트랜잭션 수수료를 추적하고 제공합니다. 이러한 사이트는 트랜잭션이 빠르게 처리되기 위해 필요한 수수료 수준을 실시간으로 보여줍니다. 예를 들면, [Mempool.space](https://mempool.space/), [Bitcoinfees.earn.com](https://bitcoinfees.earn.com/), [BTC.com](https://btc.com/stats/unconfirmed-tx) 등이 있습니다.
    - **지갑 소프트웨어**: 대부분의 비트코인 지갑은 트랜잭션을 전송할 때 적절한 수수료를 자동으로 계산해주는 기능을 제공합니다. 사용자는 트랜잭션 우선순위(빠른 전송, 보통 전송, 느린 전송 등)에 따라 수수료를 설정할 수 있습니다.
    - **네트워크 상태 모니터링**: 비트코인 블록체인의 상태를 모니터링하는 도구를 통해 현재 네트워크의 혼잡도를 파악할 수 있습니다. 네트워크가 혼잡할수록 수수료가 높아질 가능성이 큽니다.

3. **비트코인 수수료 추적 사이트의 예시**:
    - **Mempool.space**: 현재 네트워크 상태와 추천 수수료 수준을 보여줍니다. 사용자는 트랜잭션 크기와 원하는 처리 속도에 따라 적절한 수수료를 설정할 수 있습니다.
    - **Bitcoinfees.earn.com**: 현재의 평균 수수료와 각 수수료 수준에 따른 예상 처리 시간을 제공합니다.
    - **BTC.com**: 블록체인의 현재 상태와 확인되지 않은 트랜잭션 수를 보여줍니다. 이를 통해 적절한 수수료 수준을 판단할 수 있습니다.

4. **지갑 소프트웨어 사용**:
    - 대부분의 지갑 소프트웨어는 사용자가 트랜잭션을 보낼 때 실시간으로 네트워크 수수료 정보를 제공하고, 적절한 수수료를 추천해줍니다.
    - 사용자 설정 옵션을 통해 빠른 전송, 표준 전송, 저비용 전송 등 여러 옵션을 선택할 수 있습니다.

사용자는 이러한 정보를 통해 현재의 바이트당 수수료 수준을 파악하고, 적절한 수수료를 설정하여 트랜잭션을 보낼 수 있습니다. 트랜잭션이 빠르게 처리되기를 원한다면, 해당 시점의 평균 수수료보다 높은 수수료를 설정하는 것이 좋습니다.



## 사토시 (sats) 단위

비트코인에서 소액 단위인 "사토시(Satoshi)"는 비트코인의 가장 작은 단위입니다. 사토시는 비트코인의 창시자인 사토시 나카모토(Satoshi Nakamoto)의 이름을 따서 명명되었습니다. 비트코인과 사토시의 관계는 다음과 같습니다:

1 비트코인 (BTC) = 100,000,000 사토시 (sats)

### 사토시에 대한 세부 정보

1. **정의**:
   - 1 사토시 = 0.00000001 비트코인 (BTC)

2. **이름의 유래**:
   - 사토시라는 이름은 비트코인의 창시자인 사토시 나카모토를 기리기 위해 사용되었습니다.

### 사토시의 사용 사례

1. **소액 결제**:
   - 사토시는 비트코인의 소액 결제를 가능하게 합니다. 이는 비트코인의 가치가 상승함에 따라 더욱 중요해졌습니다. 예를 들어, 커피 한 잔을 구매하거나 소규모 기부를 할 때 사토시 단위가 유용합니다.

2. **비트코인 거래소 및 지갑**:
   - 대부분의 비트코인 거래소와 지갑은 사용자에게 사토시 단위로 잔액을 표시할 수 있는 옵션을 제공합니다. 이는 비트코인의 소액 거래를 더 쉽게 이해하고 관리할 수 있게 합니다.

3. **프로토콜 및 개발자 사용**:
   - 비트코인 프로토콜과 관련 개발에서 사토시는 매우 중요한 역할을 합니다. 모든 트랜잭션은 사토시 단위로 처리되며, 이는 개발자들이 보다 정밀하게 비트코인 네트워크를 관리하고 개선하는 데 도움을 줍니다.

### 사토시의 장점

1. **미세 조정**:
   - 사토시는 비트코인의 거래를 매우 정밀하게 조정할 수 있게 합니다. 이는 특히 작은 가치의 트랜잭션을 처리할 때 유용합니다.

2. **비트코인 확장성**:
   - 사토시는 비트코인의 확장성과 채택을 촉진합니다. 비트코인의 가치가 상승할 때, 사토시 단위는 소액 거래를 가능하게 하여 비트코인의 실용성을 유지합니다.

### 요약

사토시는 비트코인의 가장 작은 단위로, 1 비트코인은 1억 사토시로 구성됩니다. 이는 비트코인의 소액 거래를 가능하게 하며, 비트코인의 확장성과 실용성을 높이는 데 중요한 역할을 합니다. 사토시 단위는 비트코인의 일상적인 사용, 프로토콜 관리, 그리고 개발에 있어서 핵심적인 요소입니다.
